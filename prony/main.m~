clear all;
clc;
close all;

f1 = 7600; %Hz
f2 = 7500; %Hz
f3 = 2200; %Hz

A1 = 5;
A2 = 1; % if A2 = 0, harmonic down
A3 = 10;

T  = 0.1;
fs = 20000.0;
t  = 0:1/fs:T;
n  = length(t);
noise_ampl = 0;
noise = normrnd(1,n);
S = A1*exp(1i*2*pi*f1*t)+A2*exp(1i*2*pi*f2*t)+A3*exp(1i*2*pi*f3*t)+noise_ampl*noise*(1+1i);

a = lpc(S,3);
a = [1  a(2:end)]
% Функция lpc определяет коэффициенты предсказывающего фильтра 
% путем минимизации среднего квадрата ошибки предсказания.
z = roots(a);
w = 1/(1/fs) * (imag(log(z)));
F = (-1)/(1/fs) * (real(log(z)));
F = round(sort(F))
F_input = [f1,f2,f3]';
MSE = std(F_input - F)